package pubsub;

import com.google.cloud.pubsub.v1.Publisher;
import com.google.cloud.pubsub.v1.SubscriptionAdminClient;
import com.google.cloud.pubsub.v1.TopicAdminClient;
import com.google.protobuf.ByteString;
import com.google.pubsub.v1.ProjectTopicName;
import com.google.pubsub.v1.PubsubMessage;
import com.google.pubsub.v1.PushConfig;

public class GCloudPubSubService {

    public void createTopic(String projectId, String topicName) {

        try (TopicAdminClient topicClient = TopicAdminClient.create()) {
            ProjectTopicName projectTopicName = ProjectTopicName.of(projectId, topicName);
            topicClient.createTopic(projectTopicName);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void createPullSubscription(String topicName, String subscriptionName) {

        try (SubscriptionAdminClient subscriptionAdminClient = SubscriptionAdminClient.create()) {
            // create a pull subscription with default acknowledgement deadline (= 10 seconds)
            subscriptionAdminClient.createSubscription(
                    subscriptionName, topicName, PushConfig.getDefaultInstance(), 0);
            subscriptionAdminClient.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void publish(String projectId, String topicName, PubsubMessage pubsubMessage) throws Exception {
        Publisher publisher = null;
        try {
            ProjectTopicName projectTopicName = ProjectTopicName.of(projectId, topicName);
            publisher = Publisher.newBuilder(projectTopicName).build();
            publisher.publish(pubsubMessage);
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            // When finished with the publisher, shutdown to free up resources.
            if (publisher != null)
                publisher.shutdown();
        }
    }

    public void publish(String projectId, String topicName, int nbMessages) throws Exception {

        Publisher publisher = null;
        try {
            ProjectTopicName projectTopicName = ProjectTopicName.of(projectId, topicName);
            publisher = Publisher.newBuilder(projectTopicName).build();
            String message = "{ \"nextPageToken\": \"test_glc_2\", \"incompleteSearch\": false, \"files\": [  {   \"kind\": \"drive#file\",   \"id\": \"1IkgQ4c-vEEav4rh1mbV8SJYKCuhvEz-0t0c8f-H4Tgk\",   \"name\": \"REV EN Certified Trainer Application Form [Application form]\",   \"mimeType\": \"application/vnd.google-apps.form\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1Igqgzh0CsI8folmheRg02NqsbA3mv3NeQZAElK4Gx1M\",   \"name\": \"Solvay - G Suite Major Announcements '18\",   \"mimeType\": \"application/vnd.google-apps.presentation\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1IS7MjZCZyd40n4c-i0nVegYy9GmwONc-VR5DFE0yHCo\",   \"name\": \"Headquarters news spreadsheets\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"0B9S5VIBfjnGySGpLSlNHN3Zad2s\",   \"name\": \"Byte Me Indesit - SIGNED Engagement Letter Webinar Dic 2014.pdf\",   \"mimeType\": \"application/pdf\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1Ez96DiJx9-d6BHdlmc3CILwPiAiuED5l\",   \"name\": \"revevol.pdf\",   \"mimeType\": \"application/pdf\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1QiiOncxqeOX-BK4s1RAEoYXLK3UFJFa29nKbM5JZDAA\",   \"name\": \"V2 - Kiloutou - Proposition d'accompagnement Pilote WP\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1JP1i32MHP5kTe1smXMfDXO9-a7iXeQYq51_LKl2062Q\",   \"name\": \"Stagiaire Change Management\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"0B9S5VIBfjnGybmllcUtxTEJRWGM\",   \"name\": \"Revevol-Contract.pdf\",   \"mimeType\": \"application/pdf\"  },  {   \"kind\": \"drive#file\",   \"id\": \"18Nlj2X63aHu1EJqvuNDrVkuPKlDOY0AK\",   \"name\": \"2016July19-Weerasak-EngagementLetterforCYTECwebinars072016.pdf\",   \"mimeType\": \"application/pdf\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1lCxNvFfUppzSVMQSuciB-k1uKU0iHy-J\",   \"name\": \"CT Denmark\",   \"mimeType\": \"application/vnd.google-apps.folder\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1Bg2hCfeMZVETN-ed5Kw1L40wCSN0qu_0\",   \"name\": \"Nicolas Gartner-Engagement Letter for Solvay SUCCESS Training - July 2014.pdf\",   \"mimeType\": \"application/pdf\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1H_qD5rCDz4F_BOPfvx9_qKiqlhdwDDWtyb0J1OYnFZA\",   \"name\": \"Solvay - Documentum - QDMS application - Business proposal\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1_wPvIwFRoREWs1htTL_1_PKo4dNizTrKOgzqLBD_a3k\",   \"name\": \"[DRAFT] AODocs R&D weekly - W36\",   \"mimeType\": \"application/vnd.google-apps.presentation\"  },  {   \"kind\": \"drive#file\",   \"id\": \"0B_gGp0CCWa_wWUU5YkJ1MmFRVlpBZzAxNVRPdk1HRG1Yc3Z3\",   \"name\": \"Certificate_AcceptanceRevevol2016.4CYTEC.pdf\",   \"mimeType\": \"application/pdf\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1hWrTGRfExIYOm72IxB614jdbtgg3O2MrrAei0cXx-QE\",   \"name\": \"Claracs - Engagement Letter for CYTEC - 04/2016\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"12dTJwWAX2Gse0eHrrIRTP_S5wjDygTBAlm0Zrr4xyck\",   \"name\": \"Contacts Query\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1ef8LRcXXnQTUHQoB82ONlaayDrF_zN19\",   \"name\": \"Workplace by facebook - Starbucks annual shareholder meeting 2017.mp4\",   \"mimeType\": \"video/mp4\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1ghAYcYq2a3vVHFumjC0UAoHIozah-ATN\",   \"name\": \"Technspire (0365)\",   \"mimeType\": \"application/vnd.google-apps.folder\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1V9FPU_BQUcnwdqlOm7rRGA9HSNbtH4fxk8hOlB0h6S4\",   \"name\": \"Top 10 Projects\",   \"mimeType\": \"application/vnd.google-apps.presentation\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1WAqU_XlLPqehJPLkZwyQznqhixC5eruC\",   \"name\": \"Active\",   \"mimeType\": \"application/vnd.google-apps.folder\"  },  {   \"kind\": \"drive#file\",   \"id\": \"0B9S5VIBfjnGyZWFGQjF4QjZIVFU\",   \"name\": \"REV Change Management\",   \"mimeType\": \"application/vnd.google-apps.folder\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1wRRDAR5rBolZSRkP7bj_c0BV6bvFmNeQ1ryRsSsIoXY\",   \"name\": \"Cost Calculation Change Program 2019-2020 [to be shared]\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1i0g-JLDgI5SWzZ_RUZedXK3qDK4nqBZcbRyz2LaBvXM\",   \"name\": \"CRH Trainer Accounts\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1NVZpnsnLSISWB89DCycuRITfsU1SKLKqBV3E1pzx0Vg\",   \"name\": \"Quality Dashboard (concatenated results)\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1GJ3bE5g4vq-lW4xGXfGlWxdgVJBATGI_6cqMQi27omY\",   \"name\": \"Release Notes R48\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1M_WbdgGYx6rHu9hBXyxgrfPdTh6IqcaZ9sCitXZQzrg\",   \"name\": \"CSV Relation complaints actions plans - Complaints\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1ZHVZlzMhXtxpufaB5QLjG8xqr7PNIy7Y7so8TYskyP0\",   \"name\": \"Accounts - Sample Request\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"16wmyGfCCZnBqNCi_GzWTjJ1YxAUx96gdDfp-jpokJ3o\",   \"name\": \"Accounts - Visit Reports\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"11NoXzh_jhNgXMUxkJI26NXeYoY5PrfPm9G1buMCzNxk\",   \"name\": \"Accounts - Customer Request\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"13lWr1LRDqmXGdXPiCAGGlHBQPuu1IldHruqXjpkKN-Y\",   \"name\": \"Binding-Complaints\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1hBfskQbeDWGc9Ewt-PLjEHbDx9aygk0ceq76DRpd4pw\",   \"name\": \"Babel - Support Applicatif - fin 2018\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1QXeKIBJPz6mTaKx9ocYM-jIqKLZPiFQHwFVWnFGdc4k\",   \"name\": \"Babel - Support Applicatif - 2019\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1ofLFZNlfqJ8iDxA_i5AtITgtVOnLr1hIIXgouhbnkPA\",   \"name\": \"Trainer Report [Active]\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1ZGDx63CJPiANo1FutJZq81NOWVsJhKKQ6O-1FL49NXA\",   \"name\": \"csv-Complaints1\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"162utro-Ln3xCItrg6Ah9Y7iiwUz9ORbtQFC6cW9CpBA\",   \"name\": \"csv-Complaints2\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1N20ZH_WhcuqG4rd7vocfYoHM1uAGyuVTyhSFmytaeOk\",   \"name\": \"New Release - AODocs 48 \",   \"mimeType\": \"application/vnd.google-apps.presentation\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1XYwED1r46xFTrWyjwNfJQuhlvmfFfwzG\",   \"name\": \"CSV finaux pour relations\",   \"mimeType\": \"application/vnd.google-apps.folder\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1fgwf09y4Y5Ok6L2415tDC3s9jaWqkCBEqe2N7IBB6gQ\",   \"name\": \"CSV Relation Complaints effectiveness - Complaints\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1yoU9qPVTDwKtEppgow97X7yx6tBfNoeDwYMuqh_VrKo\",   \"name\": \"id AODocs à supprimer\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1XNo7WET_sGNfrwZU6rVrQFfioh4RdXHLmjBXUurMuiw\",   \"name\": \"report-Qpg82OY124c9RPSjui\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1IbKbQP2E9iM6_c7C-Nphpk5lKZQ_fpli\",   \"name\": \"report-Qpg82OY124c9RPSjui.csv\",   \"mimeType\": \"text/csv\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1qzqVk63h5uhBX7Bvcoiw9EYxqBDmxjrV\",   \"name\": \"Final report\",   \"mimeType\": \"application/vnd.google-apps.folder\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1GELq1o8OO4e5UN-ABogcz8xd9PI8xj3LbfSv_wHijLQ\",   \"name\": \"CSV Relation Complaints Immed - Complaints\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"13UJl16A4GDU45og4tTS0MUsG0vrUEEwwC33TykTkyj0\",   \"name\": \"Dagrofa - Planning\",   \"mimeType\": \"application/vnd.google-apps.presentation\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1OF9-ur0FqYARD7XKiaTBKYyjbB-Ir67uijdJfMH_p6g\",   \"name\": \"Meeting notes - Dagrofa AODocs implementation\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1nBz-IcWs6OejRdymNr4mFJnZJB2WfK1ekusf619S-08\",   \"name\": \"SOW - Dagrofa - AODocs Workshops\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1SYIQGLF-eJacPFnuNPoHUbx6-CvDdGTn\",   \"name\": \"evaluation_criteria_aodocs_dagrofa_eng.pptx\",   \"mimeType\": \"application/vnd.openxmlformats-officedocument.presentationml.presentation\"  },  {   \"kind\": \"drive#file\",   \"id\": \"10AuLKEFQ6VWh8NJxuamulzc9Idwru9_9SqP3_R8p0Pw\",   \"name\": \"La Meccanica Srl di Reffo - AODocs Admin Training Proposal\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1O4XOAfnmr7NdDBAAm5NSXS8yTjOje361GPJ5SRV_8LU\",   \"name\": \"Essilor - R&D - GED Qualité\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1arbflM2gtP4Z2QHTpVkMa0SOEs2FkIuMBxrOM1aUP5Q\",   \"name\": \"Knowledge Base - Lot 2\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"10LnFg7Mp2oKuMrLpkPvxXJH6GDBNy6NaR5VZawXH2wo\",   \"name\": \"CCI Sinergic / Xerfi - Proposition commerciale\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1RvqGTQci5Vc51HKviuyNkjV2y3qhCs_5SEI_E3a_m2M\",   \"name\": \"Dagrofa - File server migration - Costs\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1K0eplma8f6epmuVwpwk35Hn1cVXLB6qJxrvwJAkC0qU\",   \"name\": \"SOW Valeo - Business Proposal Template\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1zuR9hLmw72FNBmqj4n6lOwMNodnCFS7qOrLYUcLVCPE\",   \"name\": \"[CLARINS] - Proposition commerciale pour le déploiement de Workplace\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1Psek507zc8kdbfqj6DJPQdJ52GVNVV1C\",   \"name\": \"SOW_for_Wabion.pdf\",   \"mimeType\": \"application/pdf\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1flFkqZk5kZskwxH8YjPR4jQrFAA7-3-56Y6Y65q1N4M\",   \"name\": \"Seppic - Proposition commerciale - Initiation Custom Script / API \",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1DJeaMY9Re5lgCajqMWIeO3wfzfoh5bBqVZBzuqG6RPM\",   \"name\": \"Wabion for Logbau - Sharepoint Migration SOW\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1bXmbfjdbFdG2jDjvsvejVUKioi0gVqIFE8tp6_l-3_Q\",   \"name\": \"Technical considerations\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1RQOVH4rb9BnOC_5S6egoJppkmRSRC_z4quYyGxKlRMQ\",   \"name\": \"[EQIOM] - Proposition initiation à PowerBI\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"10Q4UcbJsAXEvJ-uFLrhixUdHespyKSNU\",   \"name\": \"AODocs _ Valeo - SOW - Custom Script Training.pdf\",   \"mimeType\": \"application/pdf\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1ouGrqvx9wxx1p2rQ_ERhXaCLCID7gWedkRQrUX6ZCfs\",   \"name\": \"AODocs _Valeo - SAOP Lot 3 - SOW - V5 - China - 15k\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1yBw1X5A8AEgHvltBHD5CoS4vFkAg7ibYOg8sVZd8fzM\",   \"name\": \"Frames - User workshop & Training proposal\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1cJDuolOz0U7-fa7LLeb9SBVjtiBpepIAzSWZK1UuM5I\",   \"name\": \"Lincoln Electric - Proposition commerciale - Out of AODocs\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1rU-5B7pptWv1P_PVTBJ0b9my2uSZnzRU5nTqJDSInU0\",   \"name\": \"Air Liquide - Commercial proposal for AODocs training\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1hiKj-HYoXnzYXmiTFfONafM9wmeXzss9SJhuqP8sn4I\",   \"name\": \"SO - Order Form - AODocs Projects T&M - 1\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1ErpXjT5-GzT9z9Gx4SdN40_t3KjjBafvddiZKiihyAA\",   \"name\": \"Chiffrage - Propale saop lot 3\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1vxtoGAYca8i4-mcYl39jrnId5yMT9RG55P4hqahU-I8\",   \"name\": \"BUploader watchpoints\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1NlD5hucfEtujdvl9vFyaHl8cloxKp-MNUwBE3dFiJks\",   \"name\": \"email Urbano\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"18nTawiftENFnAXtqfseyC01eoHMZNvpz-lnbHS3hAAA\",   \"name\": \"AODocs _Valeo - SAOP Lot 3 - SOW - V6 - All - 30k\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1KfZNOMpdwjxkwGFmUch8QmdbQ8EdLdsFCiupfzSrJzw\",   \"name\": \"Laurent Barra - Proposition commerciale - 1j Bulk Uploader + Consulting T&M\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1eKDh7pIu-tQzI5mW7tz171wHtioTOV7DvdGfAabsixc\",   \"name\": \"Rive Bureautique - AODocs Support & Deployment Proposal\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1x8Qenn3_cG53bvLIvfw0Y_1GxlXJFn-9cIcYPEGBYwg\",   \"name\": \"Solvay - AODocs projects follow-up\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1zngy_cQQDLfaHlj2WHTLzG5D5gz0jyd4uo1RHUSIRH0\",   \"name\": \"[LOGIC IMMO] - Proposition commerciale pour le déploiement de Workplace\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1II8VAZxfBbeJ64psbJNc_YM6Oz3rqzYOiAsU3g8SMwY\",   \"name\": \"B&B Hotels - Proposition d'accompagnement en Change Management pour un déploiement de Workplace by facebook \",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1ugzwaX6NEB9be53PKDmfpP9l30ZUwwclvYeeHPdhO7E\",   \"name\": \"[LA MUTUELLE GENERALE] - Proposition commerciale pour le deploiement de Workplace\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1ogn2e7tihen3ygseVZ80W47bPA2uLmdQ483HuQuTc_M\",   \"name\": \"[ICF] - Proposition commerciale pour le deploiement de Workplace\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"19JfXOvwqoVdDURS0FMgkXxxosIbP8J0nmF2UaVby-R0\",   \"name\": \"Gouvernement princier de Monaco - Proposition d'accompagnement en Change Management pour un déploiement de Workplace by facebook \",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1ylApvdm79MRKNpE1C8XrhCHzXn1d6In90yLhc7h8zhk\",   \"name\": \"Proposition de Services pour Provalliance - Workplace\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1O86LnmdKLjBsRayRBuYSNekgthZo-Aoj0GR62yyPusM\",   \"name\": \"Proposition de Services pour Walor - Workplace\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1l5xbyxshBw2pBSTMnvYfYLjlpmoFwgXd4yFzivq_t0w\",   \"name\": \"Proposition commerciale de Revevol - Google Week@Chargeurs\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1p7WlYBQSzpL2q1PvFXZtv-7ve2T-ruZwkVydsBqM5eM\",   \"name\": \"Proposition pour un PoC Workplace @Inhouse\",   \"mimeType\": \"application/vnd.google-apps.presentation\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1-w9uhEwerZaQ3sO2YXqaojBgVQ91cL2T9nkIkm-xAqQ\",   \"name\": \"SOW for Workplace - MOM Group - formation par pays\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1p-tyo5WQOu_DkpIOJTAT_q4nA0IWUHhLAmQB85A5-bQ\",   \"name\": \"Air Caraïbes - Proposition commerciale - Déploiement Gsuite 2018 \",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1lsJcwjbAYavmfhNb4glQlKVQnSgkoVrc1oMKAiiwPT8\",   \"name\": \"[INTERNAL] CRH coordination dashboard \",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1ej2ClDXshXQCB6M_p2jK-xLz2ndMFKdCOyl-_D81hYg\",   \"name\": \"27072018 SmartDocs - Weekly meeting (Revevol / Valeo)\",   \"mimeType\": \"application/vnd.google-apps.presentation\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1DQMaku-LnL0bieCu8WJsBTTWWgRaXLPC\",   \"name\": \"local-sync-tool-CHG3.zip\",   \"mimeType\": \"application/x-zip-compressed\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1SlzbLjp_CNc3QE1KgR1-IdHwoPdo1SKW\",   \"name\": \"CHG3 Sync\",   \"mimeType\": \"application/vnd.google-apps.folder\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1LSD9A6WweR7xPOoJP_B08aQK8-N_Bn0m\",   \"name\": \"local-sync-tool-GRE1.zip\",   \"mimeType\": \"application/x-zip-compressed\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1LSj-M6aG9M2zWKvkUoNLU4m6qrydM0g3\",   \"name\": \"GRE1 Sync\",   \"mimeType\": \"application/vnd.google-apps.folder\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1m_X0mPKSzuUZpfOO1KMMc9CeaXVq9ywL\",   \"name\": \"local-sync-tool-BUR1.zip\",   \"mimeType\": \"application/x-zip-compressed\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1YLUh7V3jxNhTdY8ug1SrNnSh8AbmSKmI\",   \"name\": \"BUR1 Sync\",   \"mimeType\": \"application/vnd.google-apps.folder\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1gYomsIY5EvOs6qqj2tY7eTNpY7J16n4c\",   \"name\": \"local-sync-tool-TUA1.zip\",   \"mimeType\": \"application/x-zip-compressed\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1KvytovMRyiraxr0lja4JbE0KHOJMesI4\",   \"name\": \"TUA1 Sync\",   \"mimeType\": \"application/vnd.google-apps.folder\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1tjuXi-IoXTcgJfTRIa01Arv5TGqkp4Qc60cx3M3BS7Y\",   \"name\": \"Cargotec - SAP SuccessFactors to AODocs connector - SoW\",   \"mimeType\": \"application/vnd.google-apps.document\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1RtP3WmLdr3Oipe4SFvRk3fzY_nqvX7E6XtfCGOjbNPY\",   \"name\": \"Cargotec - SAP SuccessFactors to AODocs connector - Estimation\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1K6QWq0cO51Fp8ioBJxl-0lkXbQPsr2eU4NAQDwR5ysQ\",   \"name\": \"Validation Result - Cannot find in the export\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1DLuQ9MFuxDv-DsMzkx6VvcPyKvxbW0eE\",   \"name\": \"MigrationValidation\",   \"mimeType\": \"application/vnd.google-apps.folder\"  },  {   \"kind\": \"drive#file\",   \"id\": \"14gN81rtt18PwnC8C9El_lILxEkrH6L6ArWC4zEjYwog\",   \"name\": \"Whirlpool - Winning Workplace - Monthly invoicing (2014)\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1wlCyFXa18bnMsKC4grFZe1bq-ynROiKYGnUt6jrPqfQ\",   \"name\": \"Copy of Remediation items: Altirnao Web Application Penetration Test 2018\",   \"mimeType\": \"application/vnd.google-apps.spreadsheet\"  },  {   \"kind\": \"drive#file\",   \"id\": \"1ibBww4SanG-svsFPuFqbccWfcBbKf4-J\",   \"name\": \"AOBox_Web_Application_Report.pdf\",   \"mimeType\": \"application/pdf\"  } ]}";
            for (int i = 0; i < nbMessages; i++) {
                //String message = "message-" + i;
                // convert message to bytes
                ByteString data = ByteString.copyFromUtf8(message);
                PubsubMessage pubsubMessage = PubsubMessage.newBuilder()
                        .setData(data)
                        .build();
                // Schedule a message to be published. Messages are automatically batched.
                publisher.publish(pubsubMessage);
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            // When finished with the publisher, shutdown to free up resources.
            if (publisher != null)
                publisher.shutdown();
        }
    }

}
